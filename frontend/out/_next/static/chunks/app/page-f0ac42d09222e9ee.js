(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1609:function(e,t,s){Promise.resolve().then(s.bind(s,6406))},6406:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ChatPage}});var a=s(7437),o=s(2265),n=s(9883),l=s(1827),r=s(3966),i=s(3523),c=s(6245),u=s(5817),d=s(4280),g=s(7972),m=s(6020),h=s(7393);let x={baseUrl:"https://api-text-generation.runpod.app",endpoints:{saveChat:"/chat/save",loadChat:"/chat/load",listChats:"/chat/history",healthCheck:"/health"}};function generateChatId(){return"chat_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}function formatChatRecord(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{id:generateChatId(),timestamp:new Date().toISOString(),messages:e.map(e=>({...e,timestamp:e.timestamp||new Date().toISOString()})),metadata:{version:"1.0",model:t.model||"unknown",...t}}}async function saveChatToR2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=formatChatRecord(e,t);console.log("\uD83D\uDCBE 通过后端API保存聊天记录到R2:",s.id);let a=await fetch("".concat(x.baseUrl).concat(x.endpoints.saveChat),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:s.id,messages:s.messages,metadata:s.metadata})});if(a.ok){let e=await a.json();return console.log("✅ 聊天记录保存成功:",s.id),{success:!0,chatId:s.id,result:e}}{let e=await a.text();throw Error("HTTP ".concat(a.status,": ").concat(e))}}catch(s){console.error("❌ 保存聊天记录失败:",s);try{let s=formatChatRecord(e,t),a="chat_backup_".concat(s.id);return localStorage.setItem(a,JSON.stringify(s)),console.log("\uD83D\uDCF1 已保存到本地存储作为备份:",a),{success:!0,chatId:s.id,storage:"local_backup"}}catch(e){return console.error("❌ 本地备份也失败:",e),{success:!1,error:s.message}}}}async function checkAPIHealth(){try{let e=await fetch("".concat(x.baseUrl).concat(x.endpoints.healthCheck));return e.ok}catch(e){return console.log("⚠️ 后端API不可用，将使用本地存储备份"),!1}}async function autoSaveChatHistory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e.length<2)return{success:!1,error:"消息太少，不需要保存"};let s=e.find(e=>"user"===e.role),a=s?s.content.substring(0,30)+(s.content.length>30?"...":""):"新对话",o=await checkAPIHealth();if(o){let s=await saveChatToR2(e,t);if(s.success)return console.log("\uD83D\uDCBE 聊天记录自动保存完成 (R2):",s.chatId),s}try{let s=formatChatRecord(e,t),o="chat_backup_".concat(s.id);return localStorage.setItem(o,JSON.stringify(s)),console.log("\uD83D\uDCF1 聊天记录自动保存完成 (本地):",s.id),{success:!0,chatId:s.id,storage:"local",title:a}}catch(e){return console.error("❌ 本地存储失败:",e),{success:!1,error:e.message}}}function exportChatAsJSON(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let s=formatChatRecord(e),a=JSON.stringify(s,null,2),o=new Blob([a],{type:"application/json"}),n=URL.createObjectURL(o),l=document.createElement("a");return l.href=n,l.download=t||"chat_".concat(s.id,".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n),console.log("\uD83D\uDCBE 聊天记录已导出为JSON文件"),{success:!0,filename:l.download}}catch(e){return console.error("❌ 导出失败:",e),{success:!1,error:e.message}}}var p=s(2601);let D=[{id:"L3.2-8X3B",name:"L3.2-8X3B.gguf",description:"18.4B参数模型",parameters:"/runpod-volume/text_models/L3.2-8X3B.gguf"},{id:"L3.2-8X4B",name:"L3.2-8X4B.gguf",description:"21B参数模型",parameters:"/runpod-volume/text_models/L3.2-8X4B.gguf"}];function ChatPage(){let[e,t]=(0,o.useState)([]),[s,x]=(0,o.useState)(null),[f,b]=(0,o.useState)(""),[y,j]=(0,o.useState)(!1),[w,v]=(0,o.useState)(D[0]),[N,C]=(0,o.useState)(!1),[S,A]=(0,o.useState)(""),[E,I]=(0,o.useState)([]),[k,P]=(0,o.useState)(!0),[T,R]=(0,o.useState)(null),[O,_]=(0,o.useState)("none"),[B,L]=(0,o.useState)(null),M=(0,o.useRef)(null);(0,o.useEffect)(()=>{console.log("\uD83D\uDD0D 模型验证 v2.0:",{modelCount:D.length,models:D.map(e=>({id:e.id,name:e.name})),selectedModel:w.id}),2!==D.length&&console.error("❌ 模型数量错误！应该只有2个模型")},[w]),(0,o.useEffect)(()=>{createNewChat()},[]),(0,o.useEffect)(()=>{if(""===S.trim())I(e);else{let t=e.filter(e=>e.title.toLowerCase().includes(S.toLowerCase())||e.messages.some(e=>e.content.toLowerCase().includes(S.toLowerCase())));I(t)}},[S,e]);let scrollToBottom=()=>{var e;null===(e=M.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,o.useEffect)(()=>{scrollToBottom()},[null==s?void 0:s.messages]);let createNewChat=()=>{if(s&&0===s.messages.length)return;let e={id:Date.now().toString(),title:"New Chat",messages:[],createdAt:new Date,lastMessage:new Date};t(t=>[e,...t]),x(e)},generateChatTitle=e=>{let t=e.trim().split(/\s+/).slice(0,4),s=t.join(" ");return s.length>20?s.substring(0,17)+"...":s},updateSessionTitle=(e,a)=>{let o=generateChatTitle(a);t(t=>t.map(t=>t.id===e.id?{...t,title:o,lastMessage:new Date}:t)),(null==s?void 0:s.id)===e.id&&x(e=>e?{...e,title:o,lastMessage:new Date}:null)},regenerateLastMessage=async()=>{if(!s||s.messages.length<2)return;let e=s.messages,a=e[e.length-2];if("user"!==a.role)return;let o=e.slice(0,-1),n={...s,messages:o};x(n),t(e=>e.map(e=>e.id===s.id?n:e)),await generateResponse(a.content,o)},generateResponse=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];j(!0);let o="rpa_YT0BFBFZYAZMQHR231H4DOKQEOAJXSMVIBDYN4ZQ1tdxlb";console.log("\uD83D\uDD11 RUNPOD_API_KEY直接设置为:",o?"".concat(o.substring(0,15),"..."):"NULL");let n=p.env.NEXT_PUBLIC_RUNPOD_ENDPOINT_ID||p.env.RUNPOD_ENDPOINT_ID||"4cx6jtjdx6hdhr",l=p.env.NEXT_PUBLIC_VITE_API_BASE_URL||p.env.VITE_API_BASE_URL||"https://api.runpod.ai/v2",r="".concat(l,"/").concat(n,"/runsync");console.log("Using API Key:",o?"".concat(o.substring(0,10),"..."):"NONE");let i=null;try{if(console.log("RunPod API Configuration:",{endpoint:r,hasApiKey:!!o,selectedModel:w,endpointId:n}),o)try{let n=a.map(e=>({role:e.role,content:"string"==typeof e.content?e.content:String(e.content||"")})).filter(e=>{let t=e.content.trim();return""!==t&&"[object Object]"!==t&&"undefined"!==t&&"null"!==t});console.log("\uD83D\uDDC2️ 过滤后的对话历史:",n);let l="default";"L3.2-8X3B"===w.id?l="default":"L3.2-8X4B"===w.id&&(l="default");let c={input:{prompt:e,system_template:l,history:n,max_tokens:1e3,temperature:.7,model_path:w.parameters,stream:!1}};console.log("\uD83D\uDCE4 发送到RunPod的请求:",{endpoint:r,selectedModelId:w.id,payload:c}),i={id:Date.now().toString(),content:"",role:"assistant",timestamp:new Date,model:w.id};let u=s;if(s&&0===a.length){let a=generateChatTitle(e);u={...s,title:a},x(u),t(e=>e.map(e=>e.id===s.id?{...e,title:a}:e))}let d={id:(Date.now()-1).toString(),content:e,role:"user",timestamp:new Date};if(u){let e=[...a.length>0?a:u.messages,d,i];u={...u,messages:e,lastMessage:new Date},x(u),t(e=>e.map(e=>e.id===u.id?u:e))}let g=await fetch(r,{method:"POST",headers:{Authorization:"Bearer ".concat(o),"Content-Type":"application/json"},body:JSON.stringify(c)});if(console.log("\uD83D\uDCE1 RunPod响应状态:",g.status),g.ok){let e=await g.json();console.log("\uD83D\uDCE6 RunPod完整响应:",JSON.stringify(e,null,2));let t="";if(console.log("\uD83D\uDD0D 开始解析响应..."),console.log("\uD83D\uDD0D data类型:",typeof e),console.log("\uD83D\uDD0D data内容:",e),e&&"object"==typeof e?(console.log("✅ data是有效对象"),console.log("\uD83D\uDD0D output存在:","output"in e),console.log("\uD83D\uDD0D output类型:",typeof e.output),console.log("\uD83D\uDD0D output内容:",e.output),null!==e.output&&void 0!==e.output?(console.log("✅ 发现output字段，开始处理"),t=String(e.output).trim(),console.log("✅ 转换后的响应:",t),"[object Object]"===t&&(console.log("⚠️ 检测到[object Object]，尝试JSON解析"),"object"==typeof e.output&&(t=e.output.text?String(e.output.text).trim():e.output.response?String(e.output.response).trim():e.output.content?String(e.output.content).trim():JSON.stringify(e.output),console.log("✅ 从对象提取的响应:",t)))):e.result?(console.log("⚠️ 没有output，尝试使用result字段"),t=String(e.result).trim(),console.log("\uD83D\uDCE4 使用result:",t)):(console.log("❌ 没有找到output或result字段"),console.log("\uD83D\uDD0D 可用字段:",Object.keys(e)),t="抱歉，服务器返回了无效的响应格式。\uD83D\uDE14")):(console.log("❌ data不是有效对象"),t="抱歉，服务器返回了无效的数据格式。\uD83D\uDE14"),console.log("\uD83C\uDFAF 解析完成，最终AI响应:",t),console.log("\uD83C\uDFAF AI响应类型:",typeof t),console.log("\uD83C\uDFAF AI响应长度:",t.length),"string"!=typeof t&&(console.log("⚠️ aiResponse不是字符串，强制转换:",typeof t),t=String(t)),t&&"[object Object]"!==t&&"undefined"!==t&&"null"!==t&&""!==t.trim()||(console.log("❌ AI响应无效或为空，使用默认消息"),t="抱歉，我无法生成回复，请重试。\uD83D\uDE14"),console.log("\uD83C\uDFAF 最终确认的AI响应 (字符串):",t),console.log("\uD83C\uDFAF 字符串长度:",t.length),t&&i){await simulateStreamingResponse(t,i),j(!1);return}}else{let e=await g.text();console.error("❌ RunPod API错误:",g.status,e)}}catch(e){console.error("❌ RunPod API调用异常:",e)}console.log("\uD83E\uDD16 使用模拟AI响应"),await new Promise(e=>setTimeout(e,1e3+2e3*Math.random()));let l=['好的，关于"'.concat(e,'"这个问题，让我想想... \uD83E\uDD14'),'我理解您询问"'.concat(e,'"的意思，这是我的想法： \uD83D\uDCAD'),'关于"'.concat(e,'"，我可以分享一些见解： ✨'),'这是个很好的话题！关于"'.concat(e,'"，以下是我的想法： \uD83C\uDFAF'),'感谢您的问题"'.concat(e,'"，这是我的观点： \uD83D\uDCDD')],c=["这是一个复杂的话题，涉及多个方面。需要考虑用户体验、技术实现和整体系统设计等关键因素。\uD83D\uDD27","有几种方法可以考虑，每种都有其优势和潜在挑战，我们应该仔细评估。⚖️","这需要一个平衡的方法，既要考虑当前的功能需求，也要考虑未来的可扩展性。\uD83D\uDE80","最有效的解决方案可能是结合现代最佳实践和经过验证的方法论。\uD83D\uDCA1","这是一个需要仔细规划和迭代开发才能取得优秀结果的领域。\uD83C\uDFA8"],u=["您希望我详细解释某个特定方面吗？\uD83E\uDD17","您对这种方法有什么想法？\uD83D\uDCAC","有什么特定的领域您想进一步探讨吗？\uD83D\uDD0D","这有助于回答您的问题吗？✅","如果您需要更多细节，请告诉我。\uD83D\uDCDA"],d=l[Math.floor(Math.random()*l.length)],g=c[Math.floor(Math.random()*c.length)],m=u[Math.floor(Math.random()*u.length)],h="".concat(d,"\n\n").concat(g,"\n\n").concat(m);if(!i){i={id:Date.now().toString(),content:"",role:"assistant",timestamp:new Date,model:w.id};let o=s;if(s&&0===a.length){let a=generateChatTitle(e);o={...s,title:a},x(o),t(e=>e.map(e=>e.id===s.id?{...e,title:a}:e))}let n={id:(Date.now()-1).toString(),content:e,role:"user",timestamp:new Date};if(o){let e=[...a.length>0?a:o.messages,n,i];o={...o,messages:e,lastMessage:new Date},x(o),t(e=>e.map(e=>e.id===o.id?o:e))}}await simulateStreamingResponse(h,i)}catch(a){console.error("\uD83D\uDCA5 生成响应时出错:",a);let e={id:Date.now().toString(),content:"抱歉，我遇到了一个错误：".concat(a instanceof Error?a.message:"未知错误"," \uD83D\uDE14"),role:"assistant",timestamp:new Date};if(s){let a=[...s.messages,e],o={...s,messages:a};x(o),t(e=>e.map(e=>e.id===s.id?o:e))}}j(!1)},simulateStreamingResponse=async(e,a)=>{let o=e.split(" "),n="";for(let e=0;e<o.length;e++){if(n+=(e>0?" ":"")+o[e],s){let e=s.messages.map(e=>e.id===a.id?{...e,content:n}:e),o={...s,messages:e,lastMessage:new Date};x(o),t(e=>e.map(e=>e.id===s.id?o:e))}await new Promise(e=>setTimeout(e,50+100*Math.random()))}if(k&&s&&s.messages.length>=2)try{_("saving"),console.log("\uD83D\uDCBE 自动保存聊天记录到R2...");let e=await autoSaveChatHistory(s.messages,{model:w.id,persona:"default",temperature:.7,timestamp:new Date().toISOString()});e.success?(console.log("✅ 聊天记录已保存到R2:",e.chatId),R(new Date),_("storage"in e&&"local"===e.storage?"local":"saved")):(console.error("❌ 聊天记录保存失败:","error"in e?e.error:"Unknown error"),_("error"))}catch(e){console.error("❌ 自动保存异常:",e),_("error")}},handleSendMessage=async()=>{if(!f.trim()||y||!s)return;let e={id:Date.now().toString(),content:f.trim(),role:"user",timestamp:new Date},a=[...s.messages,e],o={...s,messages:a};x(o),t(e=>e.map(e=>e.id===s.id?o:e)),0===s.messages.length&&updateSessionTitle(s,e.content),b(""),await generateResponse(e.content,a)},testApiKeyDirect=async()=>{console.log("\uD83E\uDDEA Direct API Key Test Started");let e="rpa_YT0BFBFZYAZMQHR231H4DOKQEOAJXSMVIBDYN4ZQ1tdxlb";console.log("\uD83D\uDD11 Test API Key:",e?"".concat(e.substring(0,15),"..."):"NULL");try{let t=await fetch("https://api.runpod.ai/v2/4cx6jtjdx6hdhr/runsync",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({input:{prompt:"Direct test from main page"}})});if(console.log("\uD83E\uDDEA Test Response Status:",t.status),t.ok){let e=await t.json();console.log("\uD83E\uDDEA Test Response Data:",e),alert("✅ API Test Success!\nOutput: ".concat(e.output))}else console.log("\uD83E\uDDEA Test Error:",await t.text()),alert("❌ API Test Failed: ".concat(t.status))}catch(e){console.log("\uD83E\uDDEA Test Exception:",e),alert("❌ API Test Exception: ".concat(e))}};return(0,a.jsxs)("div",{className:"h-screen flex bg-white",children:[(0,a.jsxs)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-black",children:"CHAT A.I+"}),(0,a.jsx)("a",{href:"/test",className:"text-sm text-blue-600 hover:text-blue-800 underline mt-2 block",children:"\uD83D\uDD27 API 测试页面"})]}),(0,a.jsx)("div",{className:"px-6 mb-6",children:(0,a.jsxs)("button",{onClick:createNewChat,className:"w-full flex items-center gap-3 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[(0,a.jsx)(n.Z,{size:18}),"New chat"]})}),(0,a.jsx)("div",{className:"px-6 mb-6",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(l.Z,{size:18,className:"absolute left-3 top-3 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search conversations...",value:S,onChange:e=>A(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-600 mb-3",children:"Your conversations"}),(0,a.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,a.jsx)("button",{onClick:()=>{x(e)},className:"w-full text-left p-3 rounded-lg transition-colors ".concat((null==s?void 0:s.id)===e.id?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-800"),children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-medium truncate",children:e.title&&"New Chat"!==e.title?e.title:"新对话"}),(0,a.jsx)("p",{className:"text-sm opacity-75 truncate",children:e.messages.length>0?"".concat(e.messages.length," 条消息"):"开始对话..."}),(0,a.jsx)("p",{className:"text-xs opacity-60",children:e.lastMessage.toLocaleDateString()})]})})},e.id))})]}),(0,a.jsx)("div",{className:"p-6 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>C(!N),className:"w-full flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(r.Z,{size:18,className:"text-white"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:w.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:w.parameters})]})]}),(0,a.jsx)(i.Z,{size:18,className:"text-gray-400"})]}),N&&(0,a.jsx)("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-white border border-gray-200 rounded-lg shadow-xl z-20",children:D.map(e=>(0,a.jsxs)("button",{onClick:()=>{v(e),C(!1)},className:"w-full text-left p-4 hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg transition-colors",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]},e.id))})]})})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col bg-white",children:[s&&s.messages.length>0&&(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:s.title}),T&&(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["\uD83D\uDCBE 已保存到R2: ",T.toLocaleTimeString()]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["none"!==O&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs px-2 py-1 rounded-lg ".concat("saving"===O?"bg-yellow-100 text-yellow-700":"saved"===O?"bg-green-100 text-green-700":"local"===O?"bg-blue-100 text-blue-700":"error"===O?"bg-red-100 text-red-700":""),children:["saving"===O&&"⏳ 保存中...","saved"===O&&"✅ 已保存到云端","local"===O&&"\uD83D\uDCF1 已保存到本地","error"===O&&"❌ 保存失败"]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,a.jsx)("input",{type:"checkbox",checked:k,onChange:e=>P(e.target.checked),className:"rounded"}),"自动保存"]}),s.messages.length>=2&&(0,a.jsxs)("button",{onClick:async()=>{try{_("saving");let e=await autoSaveChatHistory(s.messages,{model:w.id,persona:"default",temperature:.7});e.success?(R(new Date),_("storage"in e&&"local"===e.storage?"local":"saved"),alert("✅ 聊天记录已保存")):(_("error"),alert("❌ 保存失败: "+("error"in e?e.error:"Unknown error")))}catch(e){_("error"),alert("❌ 保存异常: "+e)}},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,a.jsx)(c.Z,{size:16}),"保存"]}),s.messages.length>0&&(0,a.jsxs)("button",{onClick:()=>exportChatAsJSON(s.messages),className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,a.jsx)(u.Z,{size:16}),"导出"]}),s.messages.length>1&&(0,a.jsxs)("button",{onClick:regenerateLastMessage,disabled:y,className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:[(0,a.jsx)(d.Z,{size:16}),"重新生成"]})]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto bg-gray-50",children:s&&0!==s.messages.length?(0,a.jsxs)("div",{className:"p-6 space-y-6 max-w-4xl mx-auto w-full",children:[s.messages.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex gap-4 message-bubble ".concat("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(r.Z,{size:16,className:"text-white"})}),(0,a.jsxs)("div",{className:"max-w-2xl p-4 rounded-2xl ".concat("user"===e.role?"bg-blue-600 text-white":"bg-white text-gray-900 border border-gray-200"),children:["user"===e.role?(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:e.content}):(0,a.jsx)(h.UG,{className:"prose prose-sm max-w-none prose-headings:text-gray-900 prose-p:text-gray-700",children:e.content}),(0,a.jsxs)("div",{className:"text-xs mt-3 ".concat("user"===e.role?"text-blue-100":"text-gray-500"),children:[e.timestamp.toLocaleTimeString(),e.model&&(0,a.jsxs)("span",{className:"ml-2",children:["• ",null===(t=D.find(t=>t.id===e.model))||void 0===t?void 0:t.name]})]})]}),"user"===e.role&&(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(g.Z,{size:16,className:"text-white"})})]},e.id)}),y&&(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(r.Z,{size:16,className:"text-white"})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-4 border border-gray-200",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]}),(0,a.jsx)("div",{ref:M})]}):(0,a.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(r.Z,{size:32,className:"text-white"})}),(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"What's in your mind?"}),(0,a.jsx)("p",{className:"text-gray-600 mb-8 text-lg",children:"Start a conversation with our AI assistant. Ask questions, get help, or just chat!"}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 bg-white p-4 rounded-lg border border-gray-200",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Model:"})," ",w.name]}),(0,a.jsx)("p",{children:w.description})]})]})})}),(0,a.jsx)("div",{className:"p-6 bg-white border-t border-gray-200",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("textarea",{value:f,onChange:e=>b(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),handleSendMessage())},placeholder:"What's in your mind?",className:"w-full p-4 pr-14 border border-gray-200 rounded-2xl resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-900 placeholder-gray-500",rows:1,style:{minHeight:"56px",maxHeight:"160px"}}),(0,a.jsx)("button",{onClick:handleSendMessage,disabled:!f.trim()||y,className:"absolute right-2 bottom-2 p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,a.jsx)(m.Z,{size:18})})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Using ",w.name," • Press Enter to send, Shift+Enter for new line"]}),(0,a.jsx)("button",{onClick:testApiKeyDirect,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:"\uD83E\uDDEA Test API"})]})]})})]})]})}}},function(e){e.O(0,[317,971,472,744],function(){return e(e.s=1609)}),_N_E=e.O()}]);